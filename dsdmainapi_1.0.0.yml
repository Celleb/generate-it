swagger: '2.0'
info:
  description: The version numbers are independant to the yaml files
  version: 1.0.0
  title: dsd_backend_main_swagger
  contact:
    email: info@acrontum.de
  license:
    name: private
    url: 'https://www.acrontum.de'
schemes:
  - http
  - https
consumes:
  - application/json
produces:
  - application/json; charset=utf-8
host: bmw-dsd-backend-main-default.acs-thor.lan
basePath: /main/
securityDefinitions:
  jwtToken:
    type: apiKey
    name: Authorization
    in: header
parameters:
  queryCustomerText:
    in: query
    name: text
    required: true
    type: string
    minLength: 7
    maxLength: 17
    description: 'String can be one of the following: short VIN, VIN'
    x-example: WBACW21080LB42374
  queryLanguage:
    in: query
    name: language
    required: false
    type: string
    enum:
      - en
      - de
    description: Language of the requested file with format ISO 639-1
    x-example: en
  querySource:
    in: query
    name: source
    type: string
    required: false
    x-example: en
    enum:
      - INTERNET
      - CALLCENTER
      - AMSTORE
    description: Source of the requested offers
  pathVIN:
    in: path
    name: vin
    type: string
    description: The VIN of the car
    required: true
    x-example: WBACW21080LB42374
  pathMSISDN:
    in: path
    name: msisdn
    type: string
    description: The MSISDN of the SIM card
    required: true
    x-example: 00491728276327632978364
  pathGCID:
    in: path
    name: gcid
    type: string
    description: The GCID of the customer
    required: true
    x-example: 569eecd9-9962-4aed-a0f0-30476c6a82ed
  queryGCID:
    in: query
    name: gcid
    required: false
    type: string
    description: The GCID of the customer
    x-example: 569eecd9-9962-4aed-a0f0-30476c6a82ed
  pathVehicleGroup:
    in: path
    name: vehicleGroup
    type: string
    description: The vehicle group to change to
    required: true
    x-example: private
  pathLanguage:
    in: path
    name: language
    type: string
    required: true
    enum:
      - cs
      - da
      - de
      - en
      - es
      - fi
      - fr
      - it
      - ja
      - ko
      - nl
      - 'no'
      - pl
      - pt
      - ru
      - sv
      - tr
    description: Language of the requested file with format ISO 639-1
  queryProducts:
    in: query
    name: products
    type: array
    required: true
    items:
      type: string
  headerSearchId:
    in: header
    name: Search-Id
    type: string
    description: Unique search id
    x-example: 569eecd9-9962-4aed-a0f0-30476c6a82ed
paths:
  /customer/search/:
    get:
      tags:
        - customer
      summary: Search for a user
      operationId: customerSearchGet
      description: |
        Search for a user
      parameters:
        - $ref: '#/parameters/queryCustomerText'
      responses:
        '200':
          description: success
          schema:
            $ref: '#/definitions/CustomerSearchModel'
        '404':
          description: Not found
      security:
        - jwtToken: []
  '/vehicle/sms-ping/{msisdn}':
    post:
      tags:
        - vehicle
      summary: Post SMS trigger
      operationId: vehicleSmsPingPost
      description: |
        Send an SMS to the vehicle to trigger a reprovisioning
      parameters:
        - $ref: '#/parameters/pathMSISDN'
      responses:
        '200':
          description: success
          schema:
            $ref: '#/definitions/SMSPingModel'
        '404':
          description: Not found
      security:
        - jwtToken: []
  /vehicle/nop-trigger:
    post:
      tags:
        - vehicle
      summary: Trigger NOP check
      operationId: vehicleNopTriggerPost
      description: |
        Trigger NOP check
      parameters:
        - in: body
          name: nopTriggerPost
          required: true
          description: NOP trigger
          schema:
            $ref: '#/definitions/NOPTriggerBody'
      responses:
        '200':
          description: success
        '404':
          description: Not found
      security:
        - jwtToken: []
  '/vehicle/{vin}/':
    get:
      tags:
        - vehicle
      summary: Fetch vehicle data
      operationId: vehicleVinGet
      description: |
        Fetch vehicle data
      parameters:
        - $ref: '#/parameters/pathVIN'
        - $ref: '#/parameters/headerSearchId'
      responses:
        '200':
          description: success
          schema:
            $ref: '#/definitions/VehicleModel'
        '404':
          description: Not found
      security:
        - jwtToken: []
  '/vehicle/{vin}/sim/dewaive/{gcid}/':
    post:
      tags:
        - vehicle
      summary: Dewaive sim card
      operationId: vehicleVinSimDewaivePost
      description: |
        Dewaive a sim card for a given VIN and GCID
      parameters:
        - $ref: '#/parameters/pathVIN'
        - $ref: '#/parameters/pathGCID'
      responses:
        '204':
          description: success
        '404':
          description: Not found
      security:
        - jwtToken: []
  '/vehicle/{vin}/sim/waive/{gcid}/':
    post:
      tags:
        - vehicle
      summary: Waive sim card
      operationId: vehicleVinSimWaivePost
      description: |
        Waive a sim card for a given VIN and GCID
      parameters:
        - $ref: '#/parameters/pathVIN'
        - $ref: '#/parameters/pathGCID'
      responses:
        '200':
          description: success
        '404':
          description: Not found
      security:
        - jwtToken: []
  '/vehicle/{vin}/vehicle-group/{vehicleGroup}/':
    put:
      tags:
        - vehicle
      summary: Change vehicle group
      operationId: vehicleVinVehicleGroupPut
      description: |
        Change vehicle group for a given VIN
      parameters:
        - $ref: '#/parameters/pathVIN'
        - $ref: '#/parameters/pathVehicleGroup'
      responses:
        '200':
          description: success
        '404':
          description: Not found
      security:
        - jwtToken: []
  '/vehicle/{vin}/tiers/pressure':
    get:
      tags:
        - vehicle
      summary: Fetch tiers pressure
      operationId: vehicleVinTiersPressureGet
      description: |
        Fetch tiers pressure
      parameters:
        - $ref: '#/parameters/pathVIN'
      responses:
        '200':
          description: success
          schema:
            $ref: '#/definitions/TiersPressureModel'
        '404':
          description: Not found
  '/market-tool/products/{language}':
    get:
      tags:
        - market-tool
      summary: Get products information
      operationId: market-toolProductsGet
      description: |
        Get products information
      parameters:
        - $ref: '#/parameters/pathLanguage'
        - $ref: '#/parameters/queryProducts'
      responses:
        '200':
          description: success
          schema:
            $ref: '#/definitions/ProductsModel'
        '404':
          description: Not found
      security:
        - jwtToken: []
  '/offer/{vin}/booked-products':
    get:
      tags:
        - offer
      summary: Get booked products
      operationId: offerVinBookedProductsGet
      description: |
        Get booked products for a given VIN
      parameters:
        - $ref: '#/parameters/pathVIN'
        - $ref: '#/parameters/queryGCID'
        - $ref: '#/parameters/queryLanguage'
        - $ref: '#/parameters/querySource'
      responses:
        '200':
          description: success
          schema:
            $ref: '#/definitions/BookedProductModels'
        '404':
          description: Not found
      security:
        - jwtToken: []
  '/offer/{vin}/bookable-products/{gcid}':
    get:
      tags:
        - offer
      summary: Get bookable products
      operationId: offerVinBookableProductsGcidGet
      description: |
        Get bookable products for a given VIN
      parameters:
        - $ref: '#/parameters/pathVIN'
        - $ref: '#/parameters/pathGCID'
        - $ref: '#/parameters/queryLanguage'
        - $ref: '#/parameters/querySource'
      responses:
        '200':
          description: success
          schema:
            $ref: '#/definitions/BookableProductModels'
        '404':
          description: Not found
      security:
        - jwtToken: []
  /service-partner/document:
    get:
      tags:
        - service-partner
      summary: Get service partner document
      operationId: service-partnerDocumentGet
      description: |
        Get service partner document
      produces:
        - application/PDF
      parameters:
        - $ref: '#/parameters/queryLanguage'
      responses:
        '200':
          description: success
          schema:
            type: file
        '404':
          description: Not found
      security:
        - jwtToken: []
  '/service-partner/{vin}':
    get:
      tags:
        - service-partner
      summary: Get service partner
      operationId: service-partnerVinGet
      description: |
        Get service partner for a given VIN
      parameters:
        - $ref: '#/parameters/pathVIN'
      responses:
        '200':
          description: success
          schema:
            $ref: '#/definitions/ServicePartnerModel'
        '404':
          description: Not found
      security:
        - jwtToken: []
  '/service-partner/{vin}/move':
    put:
      tags:
        - service-partner
      summary: Update service partner
      operationId: service-partnerVinMovePut
      description: |
        Update service partner
      parameters:
        - $ref: '#/parameters/pathVIN'
        - in: body
          name: service-partner
          required: true
          description: Service Partner Data
          schema:
            $ref: '#/definitions/MoveServicePartnerModel'
      responses:
        '200':
          description: success
        '404':
          description: Not found
      security:
        - jwtToken: []
  '/check-control-messages/{vin}/history':
    get:
      tags:
        - ccm
      summary: Fetch check control messages history
      operationId: check-control-messagesVinHistoryGet
      description: |
        Fetch check control messages history
      parameters:
        - $ref: '#/parameters/pathVIN'
      responses:
        '200':
          description: success
          schema:
            $ref: '#/definitions/CCMHistoryModels'
        '404':
          description: Not found
      security:
        - jwtToken: []
  '/condition-based-service/{vin}/history':
    get:
      tags:
        - conditionBasedService
      summary: Fetch condition based services history for a given VIN
      operationId: condition-based-serviceVinHistoryGet
      description: |
        Fetch condition based services history for a given VIN
      parameters:
        - $ref: '#/parameters/pathVIN'
      responses:
        '200':
          description: success
          schema:
            $ref: '#/definitions/ConditionBasedServiceHistoryModels'
        '404':
          description: Not found
      security:
        - jwtToken: []
  '/battery/{vin}/state/':
    get:
      tags:
        - battery-state
      summary: Fetch battery data for a given vin
      operationId: batteryVinStateGet
      description: |
        Fetch battery data for a given vin
      parameters:
        - $ref: '#/parameters/pathVIN'
      responses:
        '200':
          description: success
          schema:
            $ref: '#/definitions/BatteryStateModel'
        '404':
          description: Not found
      security:
        - jwtToken: []
  '/battery/{vin}/intensive-consumption-equipment':
    get:
      tags:
        - battery-state
      summary: Fetch consumption intensive optional equipment
      operationId: batteryVinIntensiveConsumptionEquipmentGet
      description: |
        Fetch consumption intensive optional equipment for a given vin
      parameters:
        - $ref: '#/parameters/pathVIN'
        - $ref: '#/parameters/queryLanguage'
      responses:
        '200':
          description: success
          schema:
            $ref: '#/definitions/IntensiveEquipmentModels'
        '404':
          description: Not found
      security:
        - jwtToken: []
  '/summary/{vin}':
    get:
      tags:
        - summary
      summary: Fetch summary information
      operationId: summaryVinGet
      description: |
        Fetch summary information
      parameters:
        - $ref: '#/parameters/pathVIN'
      responses:
        '200':
          description: success
          schema:
            $ref: '#/definitions/SummaryModels'
        '404':
          description: Not found
      security:
        - jwtToken: []
    post:
      tags:
        - summary
      summary: Post summary information
      operationId: summaryVinPost
      description: |
        Post summary information
      parameters:
        - $ref: '#/parameters/pathVIN'
        - in: body
          name: summary
          required: true
          description: Summary data
          schema:
            $ref: '#/definitions/SummaryModel'
      responses:
        '200':
          description: success
        '404':
          description: Not found
      security:
        - jwtToken: []
  /admin/health:
    get:
      tags:
        - admin
      summary: Service health check
      operationId: adminHealthGet
      description: |
        Service health check
      responses:
        '200':
          description: Success response
        '404':
          description: Not found
definitions:
  GenericSearchMeta:
    type: object
    properties:
      resultCount:
        type: number
      offset:
        type: number
      pageLimit:
        type: number
  ConditionBasedServiceHistoryModel:
    type: object
    properties:
      createdAt:
        type: string
      name:
        type: string
      description:
        type: string
      status:
        type: string
      mileageToDue:
        type: string
      mileageToDueUnit:
        type: string
      dueDate:
        type: string
      weeksSinceToday:
        type: number
  ConditionBasedServiceHistoryModels:
    type: object
    properties:
      meta:
        $ref: '#/definitions/GenericSearchMeta'
      data:
        type: array
        items:
          $ref: '#/definitions/ConditionBasedServiceHistoryModel'
  CCMHistoryModel:
    type: object
    properties:
      id:
        type: number
      shortDescription:
        type: string
      longDescription:
        type: string
      mileage:
        type: number
      createdAt:
        type: string
      weeksSinceToday:
        type: number
      urgency:
        type: number
      type:
        type: string
  CCMHistoryModels:
    type: object
    properties:
      meta:
        $ref: '#/definitions/GenericSearchMeta'
      data:
        type: array
        items:
          $ref: '#/definitions/CCMHistoryModel'
  CustomerSearchModel:
    type: object
    properties:
      owner:
        type: string
      email:
        type: string
      firstName:
        type: string
      lastName:
        type: string
      gcId:
        type: string
      market:
        type: string
      carImageURL:
        type: string
  CustomerSearchModels:
    type: object
    properties:
      meta:
        $ref: '#/definitions/GenericSearchMeta'
      data:
        type: array
        items:
          $ref: '#/definitions/CustomerSearchModel'
  VehicleModel:
    type: object
    properties:
      vin:
        type: string
      vehicleGroup:
        type: string
      modelType:
        type: string
      productionDate:
        type: string
        format: date-time
      mileage:
        type: number
      mileageUnit:
        type: string
      avgMileagePerWeek:
        type: number
  ServicePartnerModel:
    type: object
    properties:
      partner:
        type: string
      subsidiary:
        type: string
      dealerName:
        type: string
      street:
        type: string
      city:
        type: string
      email:
        type: string
      phone:
        type: string
  MoveServicePartnerModel:
    type: object
    required:
      - bu
      - spBuno
      - spDpno
      - spOutletNo
    properties:
      bu:
        type: string
        description: Business Unit
      spBuno:
        type: string
        description: Service partner BU number
      spDpno:
        type: string
        description: Service partner DP number
      spOutletNo:
        type: string
        description: Service partner OT number
  ProductsModel:
    type: array
    items:
      type: object
      properties:
        id:
          type: string
        title:
          type: string
        shortDescription:
          type: string
        longDescription:
          type: string
  SummaryModel:
    type: object
    required:
      - actions
    properties:
      id:
        type: number
        description: Summary Id
      vin:
        type: string
        description: Vin
      createdAt:
        type: string
        format: date-time
      actions:
        type: array
        items:
          $ref: '#/definitions/SummaryActionModel'
  SummaryActionModel:
    type: object
    properties:
      type:
        type: string
      name:
        type: string
      page:
        type: string
  SummaryModels:
    type: object
    properties:
      meta:
        $ref: '#/definitions/GenericSearchMeta'
      data:
        type: array
        items:
          $ref: '#/definitions/SummaryModel'
  BatteryStateModel:
    type: object
    required:
      - batteryDate
      - type
      - health
      - wear
      - chargeBalance
      - timeWithLowStateCharge
      - numberOfEngineStarts
    properties:
      id:
        type: number
        description: Battery state Id
      batteryDate:
        type: string
        format: date-time
        description: Battery age
      type:
        type: string
        description: Battery type
      health:
        type: number
        description: Battery health
      wear:
        type: number
        description: Battery wear
      chargeBalance:
        type: number
        description: Battery charge balance
      timeWithLowStateCharge:
        type: number
        description: Battery time with low state of charge
      numberOfEngineStarts:
        type: number
        description: Number of engine starts
      additionalText:
        type: string
        description: Additional text
  IntensiveEquipmentModel:
    type: object
    required:
      - code
      - description
    properties:
      code:
        type: string
        description: SA code
      description:
        type: string
        description: SA code description
  IntensiveEquipmentModels:
    type: object
    properties:
      meta:
        $ref: '#/definitions/GenericSearchMeta'
      data:
        type: array
        items:
          $ref: '#/definitions/IntensiveEquipmentModel'
  BookedProductModel:
    type: object
    required:
      - title
      - masterOfferId
      - descriptionLong
      - descriptionShort
    properties:
      title:
        type: string
      masterOfferId:
        type: string
      globalOfferId:
        type: string
      contractId:
        type: string
      subServices:
        type: array
        items:
          type: string
      status:
        type: string
      startDate:
        type: string
      endDate:
        type: string
      descriptionLong:
        type: string
      descriptionShort:
        type: string
      lastChangeReason:
        type: string
      distributionChannel:
        type: string
  BookedProductModels:
    type: object
    properties:
      meta:
        $ref: '#/definitions/GenericSearchMeta'
      data:
        type: array
        items:
          $ref: '#/definitions/BookedProductModel'
  BookableProductModel:
    type: object
    required:
      - title
      - masterOfferId
      - descriptionLong
      - descriptionShort
    properties:
      title:
        type: string
      masterOfferId:
        type: string
      subServices:
        type: array
        items:
          type: string
      descriptionLong:
        type: string
      descriptionShort:
        type: string
  BookableProductModels:
    type: object
    properties:
      meta:
        $ref: '#/definitions/GenericSearchMeta'
      data:
        type: array
        items:
          $ref: '#/definitions/BookableProductModel'
  NOPTriggerBody:
    type: object
    properties:
      vin:
        type: string
      country:
        type: string
  SMSPingModel:
    type: object
    properties:
      created_at:
        type: string
        format: date-time
      error_reason:
        type: string
      status:
        type: string
  TiersPressureModel:
    type: object
    properties:
      front:
        type: object
        properties:
          left:
            type: object
            properties:
              pressureTarget:
                type: object
                properties:
                  value:
                    type: number
                  unit:
                    type: string
              pressure:
                type: object
                properties:
                  value:
                    type: number
                  unit:
                    type: string
          right:
            type: object
            properties:
              pressureTarget:
                type: object
                properties:
                  value:
                    type: number
                  unit:
                    type: string
              pressure:
                type: object
                properties:
                  value:
                    type: number
                  unit:
                    type: string
      back:
        type: object
        properties:
          left:
            type: object
            properties:
              pressureTarget:
                type: object
                properties:
                  value:
                    type: number
                  unit:
                    type: string
              pressure:
                type: object
                properties:
                  value:
                    type: number
                  unit:
                    type: string
          right:
            type: object
            properties:
              pressureTarget:
                type: object
                properties:
                  value:
                    type: number
                  unit:
                    type: string
              pressure:
                type: object
                properties:
                  value:
                    type: number
                  unit:
                    type: string
